window.VisualisationWidgetExport=window.VisualisationWidgetExport||{},function(n){n.exportPdf=function(n,t,u,f){i(n,t,u,f,r)};n.exportPng=function(n,t,r,u){i(n,t,r,u,f)};var i=function(n,i,r,u,f){var o=i[n],c,l;if(o&&(c=$("#"+n)[0],l=powerbi.get(c),l)){const a=window.matchMedia("(min-width: 1020px)");var v={type:o.visualisationsOptions.exportSizeType,width:o.visualisationsOptions.exportWidth,height:o.visualisationsOptions.exportHeight,useMobileSize:o.visualisationsOptions.useMobileLayout&&!a.matches},s={sizeConfig:v,config:o.config!=null?o.config:null,layoutSettings:o.layoutSettings!=null?o.layoutSettings:null,theme:o.theme!=null?o.theme:null,delay:o.visualisationsOptions.exportDelay,exportCurrentPage:o.visualisationsOptions.exportCurrentPage},h=$("#"+o.visualisationsOptions.exportButtonId);t(h,!0);u(n).then(function(t){return s.currentPageIndex=t,r(n)}).then(function(n){return s.bookmarkState=n.state,f(o.visualisationsOptions,JSON.stringify(s))}).then(function(n){e(n.fileName,n.fileType,n.fileBytes);t(h,!1)},function(){t(h,!1)})}},t=function(n,t){t?(n.attr("disabled","disabled"),n.children("i").addClass("power-bi-button-loader-hidden"),n.children(".power-bi-button-loader").removeClass("power-bi-button-loader-hidden")):(n.removeAttr("disabled"),n.children("i").removeClass("power-bi-button-loader-hidden"),n.children(".power-bi-button-loader").addClass("power-bi-button-loader-hidden"));n.siblings().find("a").removeClass("active")},r=function(n,t){return u(n,t).then(function(t,i){return i===200?t:i===202?s(5e3).then(function(){return r(n,JSON.stringify({instanceId:t.instanceId}))}):void 0})},u=function(n,t){var i=$.Deferred();return url=n.screenshotServiceEndpoint+"/api/exportpdf",$.ajax({method:"POST",url:url,data:t}).done(function(n,t,r){i.resolve(n,r.status)}).fail(function(n){i.reject(n)}),i.promise()},f=function(n,t){var i=$.Deferred();return url=n.screenshotServiceEndpoint+"/api/exportpng",$.ajax({method:"POST",url:url,data:t}).done(function(n){i.resolve(n)}).fail(function(n){i.reject(n)}),i.promise()},e=function(n,t,i){var u=new Blob([o(atob(i))],{type:t}),r;window.navigator.msSaveOrOpenBlob?window.navigator.msSaveBlob(u,n):(r=document.createElement("a"),r.href=window.URL.createObjectURL(u),r.download=n,r.dispatchEvent(new MouseEvent("click")))},o=function(n){for(var i=new ArrayBuffer(n.length),r=new Uint8Array(i),t=0;t!==n.length;++t)r[t]=n.charCodeAt(t)&255;return i},s=function(n){var t=$.Deferred();return setTimeout(function(){t.resolve()},n),t.promise()}}(VisualisationWidgetExport);