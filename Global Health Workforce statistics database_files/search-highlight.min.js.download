window.SearchHighlightWidget=window.SearchHighlightWidget||{},function(n){n.highlights=n.highlights||{};n.init=function(n){r(n);$(n.searchHighlightId).click(function(){t(n);$(n.modalId).show();$(n.searchHighlightInputId).focus()});$(n.closeModalId).click(function(){$(n.modalId).hide();$(n.searchHighlightInputId).val("");i(n);r(n)});$(n.searchHighlightInputId).keyup(function(){if(event.which===13){f(n);return}a(function(n){var o,s;$(n.nextResultButtonId).unbind("click");$(n.previousResultButtonId).unbind("click");i(n);r(n);t(n);o=$(n.searchHighlightInputId).val();o&&(s=h(n,o),s&&s.length>0&&(e(n,s),u(n,o),t(n),$(n.nextResultButtonId).click(function(){f(n)}),$(n.previousResultButtonId).click(function(){l(n)})))},300,n)})};var t=function(t){var i=n.highlights[t.searchHighlightId],r,u;i.currentElement?(r=i.elements.index(i.currentElement),u=r+1+"/"+i.elements.length,$(t.statusLabelId).text(u)):$(t.statusLabelId).text("0/0")},r=function(t){n.highlights[t.searchHighlightId]={elements:[],currentElement:null}},e=function(t,i){n.highlights[t.searchHighlightId]={elements:i,currentElement:i[0]}},o=function(t){var i=n.highlights[t.searchHighlightId],r;i.currentElement&&(r=i.elements.index(i.currentElement),r=r===i.elements.length-1?0:r+1,i.currentElement=i.elements[r])},s=function(t){var i=n.highlights[t.searchHighlightId],r;i.currentElement&&(r=i.elements.index(i.currentElement),r=r===0?i.elements.length-1:r-1,i.currentElement=i.elements[r])},h=function(n,t){var r=t.toLowerCase(),i=$("*");return n.startElementId&&$("#"+n.startElementId).length>0?i=$("#"+n.startElementId).find("*"):n.startElementClass&&$("."+n.startElementClass).length>0&&(i=$("."+n.startElementClass).find("*")),i.not("title,script,style").filter(function(){var n=$(this).clone().children().remove().end().text().toLowerCase();return n.indexOf(r)!==-1&&$(this).is(":visible")})},c=function(t){var i=n.highlights[t.searchHighlightId];i.currentElement&&$([document.documentElement,document.body]).animate({scrollTop:$(i.currentElement).offset().top-100},100,"swing")},u=function(t,i){var r=n.highlights[t.searchHighlightId],u;r.currentElement&&(u=new Mark(r.currentElement),u.mark(i),c(t))},i=function(t){var i=n.highlights[t.searchHighlightId],r;i.currentElement&&(r=new Mark(i.currentElement),r.unmark())},f=function(n){var r=$(n.searchHighlightInputId).val();i(n);o(n);u(n,r);t(n)},l=function(n){var r=$(n.searchHighlightInputId).val();i(n);s(n);u(n,r);t(n)},a=function(){var n=0;return function(t,i,r){clearTimeout(n);n=setTimeout(t,i,r)}}()}(SearchHighlightWidget);