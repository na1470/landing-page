window.VisualisationWidgetScreenshot=window.VisualisationWidgetScreenshot||{},function(n){function r(n){function t(n,t){var i=(n&65535)+(t&65535),r=(n>>16)+(t>>16)+(i>>16);return r<<16|i&65535}function i(n,t){return n>>>t|n<<32-t}function u(n,t){return n>>>t}function e(n,t,i){return n&t^~n&i}function o(n,t,i){return n&t^n&i^t&i}function s(n){return i(n,2)^i(n,13)^i(n,22)}function h(n){return i(n,6)^i(n,11)^i(n,25)}function c(n){return i(n,7)^i(n,18)^u(n,3)}function l(n){return i(n,17)^i(n,19)^u(n,10)}function a(n,i){var it=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],r=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],f=new Array(64),a,y,p,k,v,w,b,d,nt,tt,g,u;for(n[i>>5]|=128<<24-i%32,n[(i+64>>9<<4)+15]=i,g=0;g<n.length;g+=16){for(a=r[0],y=r[1],p=r[2],k=r[3],v=r[4],w=r[5],b=r[6],d=r[7],u=0;u<64;u++)f[u]=u<16?n[u+g]:t(t(t(l(f[u-2]),f[u-7]),c(f[u-15])),f[u-16]),nt=t(t(t(t(d,h(v)),e(v,w,b)),it[u]),f[u]),tt=t(s(a),o(a,y,p)),d=b,b=w,w=v,v=t(k,nt),k=p,p=y,y=a,a=t(nt,tt);r[0]=t(a,r[0]);r[1]=t(y,r[1]);r[2]=t(p,r[2]);r[3]=t(k,r[3]);r[4]=t(v,r[4]);r[5]=t(w,r[5]);r[6]=t(b,r[6]);r[7]=t(d,r[7])}return r}function v(n){for(var i=Array(),u=(1<<r)-1,t=0;t<n.length*r;t+=r)i[t>>5]|=(n.charCodeAt(t/r)&u)<<24-t%32;return i}function y(n){var i,r,t;for(n=n.replace(/\r\n/g,"\n"),i="",r=0;r<n.length;r++)t=n.charCodeAt(r),t<128?i+=String.fromCharCode(t):t>127&&t<2048?(i+=String.fromCharCode(t>>6|192),i+=String.fromCharCode(t&63|128)):(i+=String.fromCharCode(t>>12|224),i+=String.fromCharCode(t>>6&63|128),i+=String.fromCharCode(t&63|128));return i}function p(n){for(var i=f?"0123456789ABCDEF":"0123456789abcdef",r="",t=0;t<n.length*4;t++)r+=i.charAt(n[t>>2]>>(3-t%4)*8+4&15)+i.charAt(n[t>>2]>>(3-t%4)*8&15);return r}var r=8,f=0;return n=y(n),p(a(v(n),n.length*r))}var t,i;n.setEncodedEmbedKey=function(n,i){var r=i[n];r&&(r.encodedEmbedKey=t(n,i))};t=function(n,t){var f=t[n],i,u,e,o;if(!f||(i=f.visualisationsOptions,!i))return null;u=!1;const s=window.matchMedia("(min-width: 1020px)");return i.useMobileLayout&&!s.matches&&(u=!0),e={widgetId:i.widgetId,reportId:i.reportId,workspaceId:i.workspaceId,filters:i.filters,slicers:i.slicers,selectedVisuals:i.selectedVisuals,themeId:i.visualisationThemeItemId,bookmarkName:i.bookmarkName,bookmarkState:i.bookmarkState,navContentPaneEnabled:i.navContentPaneEnabled,bookmarksPaneEnabled:i.bookmarksPaneEnabled,filterPaneEnabled:i.filterPaneEnabled,mobileLayout:u,isGrayscale:i.isGrayscaleScreenshot,invalidationPrefix:i.screenshotInvalidationPrefix},o=JSON.stringify(e),encodedKey=r(o)};n.getEncodedEmbedUrl=function(n,t,i){var r=i[t],u,f;return!n||!r?null:(u=r.visualisationsOptions,f=r.encodedEmbedKey,!u||!f)?null:n+"/"+u.serviceAccountName.toLowerCase()+"/"+f};n.generateEmbedScreenshot=function(n,t){var r=t[n],u,f,e,o;if(r&&(u=$("#"+n)[0],f=powerbi.get(u),f)){const s=window.matchMedia("(min-width: 1020px)");e={useMobileSize:r.visualisationsOptions.useMobileLayout&&!s.matches};o={sizeConfig:e,config:r.config!=null?r.config:null,bookmarkName:r.visualisationsOptions.bookmarkName,filters:r.visualisationsOptions.filters,applyFiltersOnLoad:r.visualisationsOptions.applyFiltersOnLoad,layoutSettings:r.layoutSettings!=null?r.layoutSettings:null,theme:r.theme!=null?r.theme:null,bookmarkState:r.visualisationsOptions.bookmarkState,containerName:r.visualisationsOptions.serviceAccountName.toLowerCase(),blobName:r.encodedEmbedKey,isGrayscale:r.visualisationsOptions.isGrayscaleScreenshot};i(r.visualisationsOptions,JSON.stringify(o))}};i=function(n,t){var i=$.Deferred();return url=n.screenshotServiceEndpoint+"/api/generatepng",$.ajax({method:"POST",url:url,data:t}).done(function(){i.resolve()}).fail(function(n){i.reject(n)}),i.promise()};n.existsEmbedScreenshot=function(n){var t=$.Deferred();return n!=null?$.ajax({method:"HEAD",url:n}).done(function(){t.resolve(!0)}).fail(function(){t.resolve(!1)}):t.resolve(!1),t.promise()}}(VisualisationWidgetScreenshot);